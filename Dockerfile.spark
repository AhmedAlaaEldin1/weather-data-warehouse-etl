FROM apache/spark:3.5.1

# ØµÙ„Ø§Ø­ÙŠØ§Øª root Ù„ØªØ«Ø¨ÙŠØª pip ÙˆØ§Ù„Ù…ÙƒØªØ¨Ø§Øª
USER root

# ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØªØ«Ø¨ÙŠØª pip
RUN apt-get update && apt-get install -y python3-pip wget

# Ù†Ø³Ø® Ù…Ù„Ù requirements.txt
COPY requirements.txt /tmp/

# ØªØ«Ø¨ÙŠØª ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
RUN pip install --no-cache-dir -r /tmp/requirements.txt

# ğŸŸ¢ ØªØ­Ù…ÙŠÙ„ Ø¯Ø±Ø§ÙŠÙØ± PostgreSQL JDBC
RUN mkdir -p /opt/spark/jars && \
    wget -O /opt/spark/jars/postgresql-42.7.3.jar https://jdbc.postgresql.org/download/postgresql-42.7.3.jar

# Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù…Ø³ØªØ®Ø¯Ù… spark Ø§Ù„Ø£ØµÙ„ÙŠ
USER spark
